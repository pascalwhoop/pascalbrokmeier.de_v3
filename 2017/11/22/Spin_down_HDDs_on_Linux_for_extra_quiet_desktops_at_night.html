<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Spin down HDDs on Linux for extra quiet desktops at night</title>
  <meta name="description" content="How to get your hard drives to shut up while you are trying to sleep at night">

  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="stylesheet" href="/assets/css/font-awesome.min.css">
  <link rel="canonical" href="http://pascalbrokmeier.de">
  <link rel="alternate" type="application/rss+xml" title="Homepage of Pascal Brokmeier" href="/feed.xml">

  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-55919824-7"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-55919824-7');
</script>

  <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Spin down HDDs on Linux for extra quiet desktops at night | Homepage of Pascal Brokmeier</title>
<meta name="generator" content="Jekyll v3.8.3" />
<meta property="og:title" content="Spin down HDDs on Linux for extra quiet desktops at night" />
<meta name="author" content="Pascal Brokmeier" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="How to get your hard drives to shut up while you are trying to sleep at night" />
<meta property="og:description" content="How to get your hard drives to shut up while you are trying to sleep at night" />
<link rel="canonical" href="http://pascalbrokmeier.de/2017/11/22/Spin_down_HDDs_on_Linux_for_extra_quiet_desktops_at_night.html" />
<meta property="og:url" content="http://pascalbrokmeier.de/2017/11/22/Spin_down_HDDs_on_Linux_for_extra_quiet_desktops_at_night.html" />
<meta property="og:site_name" content="Homepage of Pascal Brokmeier" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-11-22T00:00:00+01:00" />
<script type="application/ld+json">
{"description":"How to get your hard drives to shut up while you are trying to sleep at night","@type":"BlogPosting","headline":"Spin down HDDs on Linux for extra quiet desktops at night","dateModified":"2017-11-22T00:00:00+01:00","datePublished":"2017-11-22T00:00:00+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://pascalbrokmeier.de/2017/11/22/Spin_down_HDDs_on_Linux_for_extra_quiet_desktops_at_night.html"},"url":"http://pascalbrokmeier.de/2017/11/22/Spin_down_HDDs_on_Linux_for_extra_quiet_desktops_at_night.html","author":{"@type":"Person","name":"Pascal Brokmeier"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <!--<script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
  <style media="screen">
      #netlify-identity-widget{
          z-index: 999;
      }
  </style>-->
</head>


  <body>
      <!-- Header -->
      <header id="header" class="reveal">
    <a href="/index.html" class="logo"><strong>PB</strong></a>
    <nav>
        <a href="#menu">Menu</a>
    </nav>
</header>
<!-- <header class="site-header" role="banner">

  <div class="wrapper">
    
    
    <a class="site-title" href="/">Homepage of Pascal Brokmeier</a>

    
      <nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
              <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
              <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
          
            
            
          
            
            
            <a class="page-link" href="/about/">About me</a>
            
          
            
            
            <a class="page-link" href="/contact/">Get in contact</a>
            
          
            
            
          
            
            
            <a class="page-link" href="/legal/">Impressum</a>
            
          
            
            
          
            
            
            <a class="page-link" href="/portfolio/">Portfolio</a>
            
          
            
            
            <a class="page-link" href="/posts/">Blog</a>
            
          
            
            
            <a class="page-link" href="/readinglist/">Reading list</a>
            
          
            
            
          
            
            
          
            
            
          
        </div>
      </nav>
    
  </div>
</header> -->

      <div id="wrapper">

          <!--  Menu  -->
          <!-- Menu -->
    <nav id="menu">
        <ul class="links">
            <li><a href="/">Home</a></li>
            <li><a href="/posts">Blog</a></li>
            <!--<li><a href="portfolio">Portfolio</a></li>-->
            <li><a href="/about">About me</a></li>
            <li><a href="/contact">Contact</a></li>
            <li><a href="https://unsplash.com/@pascalwhoop" target="_blank" class="">Photography</a></li>
            <li><a href="https://github.com/pascalwhoop" target="_blank" class="">Github</a></li>
            <li><a href="/admin">Login</a></li>
        </ul>

    </nav>


          <section id="post" class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <div class="banner">
        
        
        
        <img src="http://pascalbrokmeier.de/images/posts/2017-11-22/cover.jpg"   alt="cover for post" width="1502" height="1500" crossorigin="anonymous" />
        
        
    </div>


    <div class="inner">
        <header class="major">
            <h1 itemprop="name headline">Spin down HDDs on Linux for extra quiet desktops at night</h1>
            <p class="post-meta">
                <time datetime="2017-11-22T00:00:00+01:00" itemprop="datePublished">
                    
                    Nov 22, 2017
                </time>
                
                • <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Pascal Brokmeier</span></span>
                
            </p>
        </header>

        <div class="post-content" itemprop="articleBody">
            <p>I often up/download large amounts of files while sleeping. I am still in the process of uploading my 600GB essential personal data offsite backup to AWS Glacier. With an average upload speed of 50-150KB, that takes a loooong time. So here are some tips to get the PC to shut up while asleep. This assumes your main disk is an SSD.</p>

<h2 id="1-make-sure-no-application-is-accessing-your-hard-drives">1. Make sure no application is accessing your hard drives</h2>

<p>I have my HDDs in a ZFS cluster and one extra HDD that backs up the data of that ZFS, just in case. I don’t have much experience with ZFS and didn’t want to trust the system my personal data without a simple backup that I can wrap my head around. 
The cluster is mounted on <code class="highlighter-rouge">~/tank</code>, hence I can watch all activity on the cluster with the following command</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>inotifywait -mr --format "%T: %e --- %f%w" ~/tank/
</code></pre></div></div>

<p>I leave this running for a day and find out that the only thing that is accessing my hard drives is Albert (a clone of the OSX Alfred) every 4 hours. Good enough, that’s a decent quiet time.</p>

<h2 id="put-your-hard-drives-to-sleep">Put your hard drives to sleep</h2>

<p>I have a simple script that stops the only processes that wake my HDDs up and puts them all to sleep. I call it ‘silence’.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">function </span>silence<span class="o">(){</span>
	<span class="nb">echo</span> <span class="s2">"spinning down hard drives of zfs pool"</span>
	<span class="nb">sudo </span>hdparm <span class="nt">-Y</span> /dev/sda
	<span class="nb">sudo </span>hdparm <span class="nt">-Y</span> /dev/sdb
	<span class="nb">sudo </span>hdparm <span class="nt">-Y</span> /dev/sdc
	<span class="nb">sudo </span>hdparm <span class="nt">-Y</span> /dev/sdd
	<span class="nb">sudo </span>hdparm <span class="nt">-Y</span> /dev/sde
	<span class="nb">sudo </span>hdparm <span class="nt">-Y</span> /dev/sdg
	docker container stop plex
	pkill albert
<span class="o">}</span>
</code></pre></div></div>

<p>to check on them and to make sure they’re actually all asleep (in case my ears don’t work) I have the <code class="highlighter-rouge">issilence</code> check</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">function </span>issilence<span class="o">(){</span>
	<span class="nb">sudo </span>hdparm <span class="nt">-C</span> /dev/sda
	<span class="nb">sudo </span>hdparm <span class="nt">-C</span> /dev/sdb
	<span class="nb">sudo </span>hdparm <span class="nt">-C</span> /dev/sdc
	<span class="nb">sudo </span>hdparm <span class="nt">-C</span> /dev/sdd
	<span class="nb">sudo </span>hdparm <span class="nt">-C</span> /dev/sde
      <span class="o">}</span>
</code></pre></div></div>

<p>ok. Now they are quiet. But what about once they spin up again when albert does it’s thing?</p>

<h2 id="making-them-quiet-on-a-regular-basis-ie-automatically-spin-down">Making them quiet on a regular basis, i.e. automatically spin down</h2>

<p>Lastly, I need to tell the drives to shut up after a defined amount of time. For me that’s 10 minutes of inactivity. See
<a href="https://askubuntu.com/questions/39760/how-can-i-control-hdd-spin-down-time">here</a> and <a href="https://askubuntu.com/questions/252039/how-can-i-find-out-the-current-drive-spin-down-time">here</a> on askubuntu.com for a discussion what the difference is between <code class="highlighter-rouge">-B</code> and <code class="highlighter-rouge">-S</code>.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">function </span>alwayssilence<span class="o">(){</span>
	<span class="c">#setting their Advanced Power Management Features, see man hdparm for details</span>
	<span class="nb">sudo </span>hdparm <span class="nt">-B</span> 40 /dev/sda
	<span class="nb">sudo </span>hdparm <span class="nt">-B</span> 40 /dev/sdb
	<span class="nb">sudo </span>hdparm <span class="nt">-B</span> 40 /dev/sdc
	<span class="nb">sudo </span>hdparm <span class="nt">-B</span> 40 /dev/sdd
	<span class="nb">sudo </span>hdparm <span class="nt">-B</span> 40 /dev/sde
	<span class="c">#setting their sleep timeout to 120 and put to sleep right away</span>
	<span class="nb">sudo </span>hdparm <span class="nt">-S</span> 120 /dev/sda
	<span class="nb">sudo </span>hdparm <span class="nt">-S</span> 120 /dev/sdb
	<span class="nb">sudo </span>hdparm <span class="nt">-S</span> 120 /dev/sdc
	<span class="nb">sudo </span>hdparm <span class="nt">-S</span> 120 /dev/sdd
	<span class="nb">sudo </span>hdparm <span class="nt">-S</span> 120 /dev/sde
<span class="o">}</span>
</code></pre></div></div>

        </div>
    </div>

</section>


      </div>

      <footer id="footer">
    <div class="inner">
        <h3>Homepage of Pascal Brokmeier</h3>
        <p>Check out my about page for more, read my blog or watch me code on YouTube or just take a picture of mine for your wallpaper. I share everything for free and really enjoy good conversations about meaningful topics. Let me know if you have something to talk about.
</p>
        <ul class="icons">

            
            <li><a href="mailto:public@pascalbrokmeier.de" class="icon alt fa-envelope"></a></li>
            
            
            <li><a href="https://twitter.com/PascalBrokmeier" class="icon alt fa-twitter" rel="me"><span class="label">Twitter</span></a>
            </li>
            
            
            <li><a href="https://github.com/pascalwhoop" class="icon alt fa-github" rel="me"><span class="label">GitHub</span></a>
            </li>
            
            <!--
            <li><a href="#" class="icon alt fa-facebook"><span class="label">Facebook</span></a></li>
            <li><a href="#" class="icon alt fa-instagram"><span class="label">Instagram</span></a></li>
            <li><a href="#" class="icon alt fa-linkedin"><span class="label">LinkedIn</span></a></li>
            -->

        </ul>
        <ul class="copyright">
            <li><span class="copyleft">&copy;</span>
                
                Homepage of Pascal Brokmeier
                
            </li>
            <li>Design: some of <a href="https://html5up.net">HTML5 UP</a> adopted by me</li>
            <li><a href="/sitemap.xml">Sitemap</a></li>
            <li><a href="/legal">Legal</a></li>
        </ul>
    </div>
</footer>

<script
        src="https://code.jquery.com/jquery-3.2.1.min.js"
        integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
        crossorigin="anonymous"></script>
<script src="/assets/js/jquery.scrolly.min.js"></script>
<script src="/assets/js/jquery.scrollex.min.js"></script>
<script src="/assets/js/skel.min.js"></script>
<script src="/assets/js/util.js"></script>
<script src="/assets/js/articles.js"></script>
<!--[if lte IE 8]>
<script  src="assets/js/ie/respond.min.js"></script><![endif]-->
<script src="/assets/js/main.js"></script>




  </body>

</html>
