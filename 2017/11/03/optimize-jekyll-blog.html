<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Optimizing a Jekyll Blog with minification, image optimisation and caching on Firebase Hosting</title>
  <meta name="description" content="Moving away from a clean and technical but unoptimized jekyll blog to a CDN backed, more efficient blog with dynamic image sizing and more.">

  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="stylesheet" href="/assets/css/font-awesome.min.css">
  <link rel="canonical" href="http://pascalbrokmeier.de">
  <link rel="alternate" type="application/rss+xml" title="Homepage of Pascal Brokmeier" href="/feed.xml">

  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-55919824-7"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-55919824-7');
</script>

  <!-- Begin Jekyll SEO tag v2.6.0 -->
<title>Optimizing a Jekyll Blog with minification, image optimisation and caching on Firebase Hosting | Homepage of Pascal Brokmeier</title>
<meta name="generator" content="Jekyll v3.8.4" />
<meta property="og:title" content="Optimizing a Jekyll Blog with minification, image optimisation and caching on Firebase Hosting" />
<meta name="author" content="Pascal Brokmeier" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Moving away from a clean and technical but unoptimized jekyll blog to a CDN backed, more efficient blog with dynamic image sizing and more." />
<meta property="og:description" content="Moving away from a clean and technical but unoptimized jekyll blog to a CDN backed, more efficient blog with dynamic image sizing and more." />
<link rel="canonical" href="http://pascalbrokmeier.de/2017/11/03/optimize-jekyll-blog.html" />
<meta property="og:url" content="http://pascalbrokmeier.de/2017/11/03/optimize-jekyll-blog.html" />
<meta property="og:site_name" content="Homepage of Pascal Brokmeier" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-11-03T00:00:00+01:00" />
<script type="application/ld+json">
{"datePublished":"2017-11-03T00:00:00+01:00","description":"Moving away from a clean and technical but unoptimized jekyll blog to a CDN backed, more efficient blog with dynamic image sizing and more.","author":{"@type":"Person","name":"Pascal Brokmeier"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://pascalbrokmeier.de/2017/11/03/optimize-jekyll-blog.html"},"@type":"BlogPosting","url":"http://pascalbrokmeier.de/2017/11/03/optimize-jekyll-blog.html","headline":"Optimizing a Jekyll Blog with minification, image optimisation and caching on Firebase Hosting","dateModified":"2017-11-03T00:00:00+01:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <!--<script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
  <style media="screen">
      #netlify-identity-widget{
          z-index: 999;
      }
  </style>-->
</head>


  <body>
      <!-- Header -->
      <header id="header" class="reveal">
    <a href="/index.html" class="logo"><strong>PB</strong></a>
    <nav>
        <a href="#menu">Menu</a>
    </nav>
</header>
<!-- <header class="site-header" role="banner">

  <div class="wrapper">
    
    
    <a class="site-title" href="/">Homepage of Pascal Brokmeier</a>

    
      <nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
              <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
              <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
          
            
            
          
            
            
            <a class="page-link" href="/about/">About me</a>
            
          
            
            
            <a class="page-link" href="/contact/">Get in contact</a>
            
          
            
            
          
            
            
            <a class="page-link" href="/legal/">Impressum</a>
            
          
            
            
          
            
            
            <a class="page-link" href="/portfolio/">Portfolio</a>
            
          
            
            
            <a class="page-link" href="/posts/">Blog</a>
            
          
            
            
            <a class="page-link" href="/readinglist/">Reading list</a>
            
          
            
            
          
            
            
          
            
            
          
        </div>
      </nav>
    
  </div>
</header> -->

      <div id="wrapper">

          <!--  Menu  -->
          <!-- Menu -->
    <nav id="menu">
        <ul class="links">
            <li><a href="/">Home</a></li>
            <li><a href="/posts">Blog</a></li>
            <!--<li><a href="portfolio">Portfolio</a></li>-->
            <li><a href="/about">About me</a></li>
            <li><a href="/contact">Contact</a></li>
            <li><a href="https://unsplash.com/@pascalwhoop" target="_blank" class="">Photography</a></li>
            <li><a href="https://github.com/pascalwhoop" target="_blank" class="">Github</a></li>
            <li><a href="/admin">Login</a></li>
        </ul>

    </nav>


          <section id="post" class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <div class="banner">
        
        
        
        <img src="https://res.cloudinary.com/pascal-brokmeier/image/fetch/c_limit,f_auto,q_auto,w_1600/http://pascalbrokmeier.de/images/posts/2017-11-03/cover.jpg" srcset="https://res.cloudinary.com/pascal-brokmeier/image/fetch/c_limit,f_auto,q_auto,w_320/http://pascalbrokmeier.de/images/posts/2017-11-03/cover.jpg 320w,
https://res.cloudinary.com/pascal-brokmeier/image/fetch/c_limit,f_auto,q_auto,w_846/http://pascalbrokmeier.de/images/posts/2017-11-03/cover.jpg 846w,
https://res.cloudinary.com/pascal-brokmeier/image/fetch/c_limit,f_auto,q_auto,w_1372/http://pascalbrokmeier.de/images/posts/2017-11-03/cover.jpg 1372w,
https://res.cloudinary.com/pascal-brokmeier/image/fetch/c_limit,f_auto,q_auto,w_1898/http://pascalbrokmeier.de/images/posts/2017-11-03/cover.jpg 1898w" sizes="(min-width: 1500px) 1500px, 100vw"   alt="cover for post" width="4272" height="2848" crossorigin="anonymous" />
        
        
    </div>


    <div class="inner">
        <header class="major">
            <h1 itemprop="name headline">Optimizing a Jekyll Blog with minification, image optimisation and caching on Firebase Hosting</h1>
            <p class="post-meta">
                <time datetime="2017-11-03T00:00:00+01:00" itemprop="datePublished">
                    
                    Nov 3, 2017
                </time>
                
                • <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Pascal Brokmeier</span></span>
                
            </p>
        </header>

        <div class="post-content" itemprop="articleBody">
            <p><strong>Where I was:</strong></p>

<ul>
  <li>Jekyll Blog hosted on Github Pages</li>
  <li>No HTTPS</li>
  <li>about 1.8MB page load</li>
  <li>PageSpeed Ranking of 61/100</li>
</ul>

<p><strong>Where I am now:</strong></p>

<ul>
  <li>Jekyll Blog hosted with Firebase Hosting</li>
  <li>HTTPS</li>
  <li>X.X MB load size on initial load</li>
  <li>X.X MB load size on subsequent load using caching</li>
  <li>PageSpeed Ranking of XX XXX</li>
  <li>Dynamicially sized images using XXXX</li>
  <li>search engine ranking improvements</li>
</ul>

<h2 id="tools-required">Tools required</h2>

<ul>
  <li>The <a href="https://nhoizey.github.io/jekyll-cloudinary/#live-example">Jekyll-Cloudinary plugin</a> is my first step. My images are huge! I had some automated size reduction going with imagemagick but this is by far better suited to do the job
    <ul>
      <li>An Atom custom snippet for the required liquid tag</li>
    </ul>
  </li>
  <li>Switching to Firebase for hosting. Reasons: Caching and SSL</li>
</ul>

<h2 id="where-we-start">Where we start</h2>
<p>I assume you have <code class="highlighter-rouge">jekyll</code> installed as well as <code class="highlighter-rouge">ruby-bundle</code> and know how to work with git(hub). If you don’t then this post is most likely not for you and you should first figure out how to set up a blog using jekyll.</p>

<h2 id="get-rid-of-those-megapixels">Get rid of those Megapixels</h2>

<p><strong>Install the jekyll plugin: <a href="https://nhoizey.github.io/jekyll-cloudinary/#installation">jekyll-cloudinary</a> and of course you need to <a href="https://cloudinary.com/invites/lpov9zyyucivvxsnalc5/flurhi5jzgzzan33ou6f">create a cloudinary accounting</a></strong></p>

<p>Now, my <code class="highlighter-rouge">_config.yml</code> looks as such</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>plugins_dir:
  - jekyll-feed
  - jekyll-sitemap
  - jekyll-seo-tag
  - jekyll-cloudinary #used for improving page load speeds with images

cloudinary:
    cloud_name:pascal-brokmeier
    presets:
    default:
      min_width: 320
      max_width: 1600
      fallback_max_width: 800
      steps: 5
      sizes: "(min-width: 50rem) 50rem, 90vw"
    banner:
      min_width: 320
      max_width: 1900
      fallback_max_width: 1600
      steps: 4
      sizes: "50vw 80vw 100vw"
</code></pre></div></div>

<p>There are several nice ways to get sexy image positioning going but I refer you to the manual of the plugin to find out more about this.</p>

<p>Now I used the new liquid tag for my main homepage (which sadly is riddled with images, but that is what I chose). Here are the results</p>

<p><img src="https://res.cloudinary.com/pascal-brokmeier/image/fetch/c_limit,f_auto,q_auto,w_800/http://pascalbrokmeier.de/images/posts/2017-11-03/before_cloudinary.png" srcset="https://res.cloudinary.com/pascal-brokmeier/image/fetch/c_limit,f_auto,q_auto,w_320/http://pascalbrokmeier.de/images/posts/2017-11-03/before_cloudinary.png 320w, https://res.cloudinary.com/pascal-brokmeier/image/fetch/c_limit,f_auto,q_auto,w_596/http://pascalbrokmeier.de/images/posts/2017-11-03/before_cloudinary.png 596w" sizes="(min-width: 50rem) 100rem, 90vw" alt="Before load times" width="596" height="119" crossorigin="anonymous" />
<img src="https://res.cloudinary.com/pascal-brokmeier/image/fetch/c_limit,f_auto,q_auto,w_800/http://pascalbrokmeier.de/images/posts/2017-11-03/after_cloudinary.png" srcset="https://res.cloudinary.com/pascal-brokmeier/image/fetch/c_limit,f_auto,q_auto,w_320/http://pascalbrokmeier.de/images/posts/2017-11-03/after_cloudinary.png 320w, https://res.cloudinary.com/pascal-brokmeier/image/fetch/c_limit,f_auto,q_auto,w_640/http://pascalbrokmeier.de/images/posts/2017-11-03/after_cloudinary.png 640w, https://res.cloudinary.com/pascal-brokmeier/image/fetch/c_limit,f_auto,q_auto,w_670/http://pascalbrokmeier.de/images/posts/2017-11-03/after_cloudinary.png 670w" sizes="(min-width: 50rem) 100rem, 90vw" alt="After load times" width="670" height="123" crossorigin="anonymous" /></p>

<p>To quickly add the snippet with Atom, I build a custom snippet that you can add to your snippets.cson</p>

<pre><code class="language-cson">'.text.html.basic, .source.gfm':
  'cloudinary':
    'prefix': 'climg'
    'body': '\{\% cloudinary ${1:default} images/posts/$2/$3 alt="$4" \%\}'
</code></pre>
<p>Hint: Remove the backticks, there is only so much possible with escaping characters with 3 different systems using each other. Otherwise my jekyll pipeline breaks.</p>
<h2 id="move-to-firebase">Move to Firebase</h2>
<p><a href="https://chris.banes.me/2017/06/02/jekyll-firebase/">Based on this post</a> the steps are quiet simple. So I’ll just summarize them in a quick checklist</p>

<ul>
  <li>Install firebase cli with <code class="highlighter-rouge">npm install -g firebase-cli</code></li>
  <li>login</li>
  <li><code class="highlighter-rouge">firebase init</code></li>
  <li>Add <code class="highlighter-rouge">circle.yml</code> file as described in post</li>
  <li>Generate firebase-cli Key and add to circle-ci.com configuration (not in the file, in their online interface)</li>
</ul>

<blockquote>
  <p><strong>In between benchmark with Google PageSpeed Tools: 86/100</strong> Not bad.</p>
</blockquote>

<h2 id="minification-and-further-speed-improvements">Minification and further speed improvements</h2>
<p>https://habd.as/pagespeed-100-with-jekyll-s3-and-cloudfront/</p>

<h2 id="get-https">Get HTTPS</h2>

<p>This one almost comes out of the box with Firebase. You just need to verify your DNS ownership of the custom domain and Google gets you a letsencrypt HTTPS certificate. Nice.</p>

<p><img src="https://res.cloudinary.com/pascal-brokmeier/image/fetch/c_limit,f_auto,q_auto,w_800/http://pascalbrokmeier.de/images/posts/2017-11-03/connect_domain.png" srcset="https://res.cloudinary.com/pascal-brokmeier/image/fetch/c_limit,f_auto,q_auto,w_320/http://pascalbrokmeier.de/images/posts/2017-11-03/connect_domain.png 320w, https://res.cloudinary.com/pascal-brokmeier/image/fetch/c_limit,f_auto,q_auto,w_640/http://pascalbrokmeier.de/images/posts/2017-11-03/connect_domain.png 640w, https://res.cloudinary.com/pascal-brokmeier/image/fetch/c_limit,f_auto,q_auto,w_960/http://pascalbrokmeier.de/images/posts/2017-11-03/connect_domain.png 960w, https://res.cloudinary.com/pascal-brokmeier/image/fetch/c_limit,f_auto,q_auto,w_960/http://pascalbrokmeier.de/images/posts/2017-11-03/connect_domain.png 960w" sizes="(min-width: 50rem) 100rem, 90vw" alt="Connect domain screenshot" width="960" height="234" crossorigin="anonymous" /></p>

<h2 id="get-caching-of-ressources">Get Caching of ressources</h2>

<p>A quick DuckDuckGo-Stackoverflow-Copy-Paste: Take the snippet below and add it to your <code class="highlighter-rouge">firebase.json</code></p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s2">"headers"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="s2">"source"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"**/*.@(eot|otf|ttf|ttc|woff|font.css)"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"headers"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"key"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Access-Control-Allow-Origin"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"value"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"*"</span><span class="w">
  </span><span class="p">}</span><span class="w"> </span><span class="p">]</span><span class="w">
</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="s2">"source"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"**/*.@(js|css)"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"headers"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"key"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Cache-Control"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"value"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"max-age=604800"</span><span class="w">
  </span><span class="p">}</span><span class="w"> </span><span class="p">]</span><span class="w">
</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="s2">"source"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"**/*.@(jpg|jpeg|gif|png)"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"headers"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"key"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Cache-Control"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"value"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"max-age=604800"</span><span class="w">
  </span><span class="p">}</span><span class="w"> </span><span class="p">]</span><span class="w">
</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="s2">"source"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"404.html"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"headers"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"key"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Cache-Control"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"value"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"max-age=300"</span><span class="w">
  </span><span class="p">}</span><span class="w"> </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w"> </span><span class="p">]</span><span class="w">
</span></code></pre></div></div>

<p>Performance Checkup:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left"> </th>
      <th style="text-align: left"> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">Before without Cache</td>
      <td style="text-align: left">1.1Mb</td>
    </tr>
    <tr>
      <td style="text-align: left">Now without Cache</td>
      <td style="text-align: left">529Kb</td>
    </tr>
    <tr>
      <td style="text-align: left">Now with Cache</td>
      <td style="text-align: left">3.5 Kb</td>
    </tr>
  </tbody>
</table>

<p>The last result just includes the index.html. Everything else is cached (CSS, JS, img). Not bad. Let’s keep going.</p>

<h2 id="do-something-for-my-pages-seo">Do something for my page’s SEO</h2>
<p>The improvements in page performance should already have led to quiet a bit of SEO improvements for the future. Google punished bad performance so improving the speed will also help with SEO. But there is more we can do.
https://github.com/jekyll/jekyll-seo-tag/blob/master/docs/usage.md</p>

<h2 id="bonus-points-a-service-worker">Bonus Points: A service worker</h2>
<h2 id="bonus-points-webmention-for-social-features">Bonus Points: Webmention for Social features</h2>

<p>TODO AT THE end
https://developers.google.com/speed/pagespeed/insights/?url=pascalbrokmeier.de&amp;tab=mobile</p>

        </div>
    </div>

</section>


      </div>

      <footer id="footer">
    <div class="inner">
        <h3>Homepage of Pascal Brokmeier</h3>
        <p>Check out my about page for more, read my blog or watch me code on YouTube or just take a picture of mine for your wallpaper. I share everything for free and really enjoy good conversations about meaningful topics. Let me know if you have something to talk about.
</p>
        <ul class="icons">

            
            <li><a href="mailto:public@pascalbrokmeier.de" class="icon alt fa-envelope"></a></li>
            
            
            <li><a href="https://twitter.com/PascalBrokmeier" class="icon alt fa-twitter" rel="me"><span class="label">Twitter</span></a>
            </li>
            
            
            <li><a href="https://github.com/pascalwhoop" class="icon alt fa-github" rel="me"><span class="label">GitHub</span></a>
            </li>
            
            <!--
            <li><a href="#" class="icon alt fa-facebook"><span class="label">Facebook</span></a></li>
            <li><a href="#" class="icon alt fa-instagram"><span class="label">Instagram</span></a></li>
            <li><a href="#" class="icon alt fa-linkedin"><span class="label">LinkedIn</span></a></li>
            -->

        </ul>
        <ul class="copyright">
            <li><span class="copyleft">&copy;</span>
                
                Homepage of Pascal Brokmeier
                
            </li>
            <li>Design: some of <a href="https://html5up.net">HTML5 UP</a> adopted by me</li>
            <li><a href="/sitemap.xml">Sitemap</a></li>
            <li><a href="/legal">Legal</a></li>
        </ul>
    </div>
</footer>

<script
        src="https://code.jquery.com/jquery-3.2.1.min.js"
        integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
        crossorigin="anonymous"></script>
<script src="/assets/js/jquery.scrolly.min.js"></script>
<script src="/assets/js/jquery.scrollex.min.js"></script>
<script src="/assets/js/skel.min.js"></script>
<script src="/assets/js/util.js"></script>
<script src="/assets/js/articles.js"></script>
<!--[if lte IE 8]>
<script  src="assets/js/ie/respond.min.js"></script><![endif]-->
<script src="/assets/js/main.js"></script>




  </body>

</html>
